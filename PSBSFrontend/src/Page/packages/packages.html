<!-- ================= PACKAGES PAGE ================= -->
<section class="py-4">
  <div class="container-fluid">

    <!-- PAGE HEADER -->
    <div class="d-flex justify-content-between align-items-center mb-4">
      <div>
        <h4 class="fw-bold mb-1">Service Packages</h4>
        <p class="text-muted mb-0">
          Manage services, pricing & add-ons
        </p>
      </div>

      <button
        class="btn btn-primary"
        data-bs-toggle="modal"
        data-bs-target="#addPackageModal">
        + Add Package
      </button>
    </div>

    <!-- ================= PACKAGES TABLE ================= -->
    <div class="card shadow-sm border-0">
      <div class="card-body table-responsive">

        <table class="table table-hover align-middle">
          <thead class="table-light">
            <tr>
              <th>SL</th>
              <th>Package</th>
              <th>Duration</th>
              <th>Edited Photos</th>
              <th>Raw Files</th>
              <th>Add-ons</th>
              <th>Price</th>
              <th class="text-center">Actions</th>
            </tr>
          </thead>

          <!-- ================= TABLE BODY ================= -->
          <tbody>

            <!-- PACKAGES LIST -->
            <tr *ngFor="let pkg of packages; let i = index">
              <td>{{ i + 1 }}</td>

              <td>
                <div class="fw-semibold">{{ pkg.name }}</div>
                <div class="small text-muted">
                  {{ pkg.description }}
                </div>
              </td>

              <td>{{ pkg.duration }}</td>

              <td>{{ pkg.editedPhotos }}</td>

              <td>
                <span
                  class="badge"
                  [ngClass]="{
                    'bg-success': pkg.rawFiles,
                    'bg-danger': !pkg.rawFiles
                  }">
                  {{ pkg.rawFiles ? 'Included' : 'Not Included' }}
                </span>
              </td>

              <td>
                <ng-container *ngIf="pkg.addOns.length > 0; else noAddons">
                  <span
                    *ngFor="let add of pkg.addOns"
                    class="badge bg-secondary me-1 mb-1">
                    {{ add }}
                  </span>
                </ng-container>

                <ng-template #noAddons>
                  <span class="text-muted small">—</span>
                </ng-template>
              </td>

              <td class="fw-semibold">
                ₹{{ pkg.price | number }}
              </td>

              <td class="text-center">

                <!-- EDIT -->
                <button
                  type="button"
                  class="btn btn-sm btn-warning me-1"
                  data-bs-toggle="modal"
                  data-bs-target="#editPackageModal"
                  (click)="openEdit(pkg)">
                  Edit
                </button>

                <!-- DELETE -->
                <button
                  type="button"
                  class="btn btn-sm btn-danger"
                  data-bs-toggle="modal"
                  data-bs-target="#deletePackageModal"
                  (click)="openDelete(pkg)">
                  Delete
                </button>

              </td>
            </tr>

            <!-- EMPTY STATE -->
            <tr *ngIf="packages.length === 0">
              <td colspan="8" class="text-center text-muted py-4">
                No packages found.
              </td>
            </tr>

          </tbody>
        </table>
      </div>
    </div>

  </div>
</section>

<!-- ================= DELETE PACKAGE MODAL ================= -->
<div
  class="modal fade"
  id="deletePackageModal"
  tabindex="-1"
  aria-hidden="true">

  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="text-danger">Delete Package</h5>
        <button type="button" class="btn-close"
          data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        Are you sure you want to delete
        <strong>{{ selectedPackage?.name }}</strong>?
      </div>

      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          data-bs-dismiss="modal">
          Cancel
        </button>

        <button
          type="button"
          class="btn btn-danger"
          (click)="deletePackage()">
          Delete
        </button>

        <!-- HIDDEN CLOSE BUTTON -->
        <button
          id="closeDeletePackageModalBtn"
          type="button"
          class="d-none"
          data-bs-dismiss="modal">
        </button>
      </div>

    </div>
  </div>
</div>

<!-- ================= ADD PACKAGE MODAL ================= -->
<div
  class="modal fade"
  id="addPackageModal"
  tabindex="-1"
  aria-hidden="true">

  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">Add Package</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal">
        </button>
      </div>

      <div class="modal-body">
        <p class="text-muted">
          Add package form will go here
        </p>
      </div>

      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          data-bs-dismiss="modal">
          Cancel
        </button>

        <button
          type="button"
          class="btn btn-primary">
          Save Package
        </button>
      </div>

    </div>
  </div>
</div>
